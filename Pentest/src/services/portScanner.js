import axios from 'axios';

// URL base del servicio de escaneo de puertos
const PORT_SCANNER_API = 'http://localhost:3002/api';

/**
 * Realiza un escaneo de puertos en una IP específica
 * @param {string} ip - Dirección IP objetivo
 * @param {string} portRange - Rango de puertos (ej: "22" o "1-1000")
 * @returns {Promise} Resultado del escaneo con puertos abiertos encontrados
 */
export const scanPorts = async (ip, portRange = '22') => {
    try {
        // Si es un solo puerto, convertirlo a formato de rango
        if (!portRange.includes('-')) {
            portRange = `${portRange}-${portRange}`;
        }
        
        console.log('Enviando request con:', { ip, portRange });
        
        // Realizar petición al servidor Python
        const response = await axios.post(`${PORT_SCANNER_API}/scan-range`, {
            ip: ip,
            portRange: portRange
        });
        
        console.log('Respuesta recibida:', response.data);
        return response.data;
    } catch (error) {
        console.error('Error en el escaneo de puertos:', error.response?.data || error);
        throw error;
    }
}; 